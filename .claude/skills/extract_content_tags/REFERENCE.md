# extract_content_tags - 详细参考文档

## 📋 工作流SOP详细说明

### 标准执行流程
```
1. 需求澄清 → 2. 文档分析 → 3. 标签提取/挖掘 → 4. 业务价值评估 → 5. 防重复检查 → 6. 正确性验证 → 7. 生成报告
```

### 详细流程说明

#### 步骤1：需求澄清（关键）
- **强制确认工作模式**：必须明确extraction（标签提取）或mining（标签挖掘）
- **查询现有标签体系**：extraction模式必须查询TaxKB现有标签
- **记录决策依据**：所有关键决策必须用户确认并记录

#### 步骤2：文档内容分析
- 文档预处理（分词、去噪、标准化）
- 提取关键概念、命名实体和专业术语
- 识别文档主题和核心内容
- 生成文档语义特征向量

#### 步骤3：标签提取/挖掘
- **extraction模式**：基于现有标签体系匹配最相关标签
- **mining模式**：从文档内容中挖掘新概念作为新标签
- 生成候选标签集合（25-50个）
- 计算置信度和相关性评分

#### 步骤4：业务价值评估（新增）
- 过滤无业务价值的标签（纯数字、时间、编号等）
- 重点提取流程类、材料类、要求类、政策类标签
- 从用户检索需求角度评估标签价值
- 标记高/中/低业务价值等级

#### 步骤5：防重复检查
- 查询现有标签体系，检测精确匹配
- 计算语义相似度（≥0.8为相似）
- 名称归一化（统一大小写、去除特殊字符）
- 执行重复处理策略（使用现有/人工审核/创建新标签）

#### 步骤6：正确性验证
- 内容匹配验证（关键词搜索、语义匹配）
- 检查文档中的证据支持
- 评估分类合理性
- 生成正确性检测报告

#### 步骤7：生成标签提取报告
- 汇总标签提取结果和统计信息
- 提供优化建议和人工审核清单
- 计算质量指标（准确率、覆盖率、效率）
- 返回结构化结果

---

## ⚠️ 核心原则详细说明

### 架构设计原则（源自实践反思）

#### 原则1：数据驱动优先
**核心思想**：所有决策必须基于实际数据，而非AI假设
- **先查询、再分析、后执行**：必须查询现有标签体系后再提取
- **基于TaxKB数据**：使用企业实际标签数据，而非AI生成
- **验证驱动**：每个标签必须有文档证据支持

#### 原则2：模式必须明确
**核心思想**：用户必须明确指定工作模式，AI不能擅自决定
- **强制用户选择**：extraction（标签提取）vs mining（标签挖掘）
- **模式适用场景**：
  - **extraction**：企业已有标准化标签体系，保证一致性
  - **mining**：企业无标准标签或探索新概念，适合创新
- **记录决策**：所有模式选择必须记录决策依据

#### 原则3：通用化而非定制化
**核心思想**：将通用逻辑沉淀到skill，通过配置实现场景适配
- **避免定制化脚本**：不生成仅针对特定场景的硬编码脚本
- **配置驱动**：通过配置文件适配不同业务场景
- **DRY原则**：通用逻辑在skill中实现，避免重复

#### 原则4：防重复机制
**核心思想**：避免重复创建相似标签，维护标签体系健康
- **先查询后创建**：创建标签前必须查询现有标签体系
- **相似度检测**：检测语义相似的标签（相似度≥0.8）
- **名称归一化**：统一大小写、去除特殊字符、标准化格式
- **标签映射表**：维护同义词映射关系

#### 原则5：业务价值评估
**核心思想**：每个标签必须通过业务价值审核
- **业务价值优先**：标签必须支持知识检索、分类和管理
- **避免无意义标签**：严格避免纯数字、时间、编号等标签
- **关键概念提取**：重点提取流程类、材料类、要求类、政策类标签
- **用户视角评估**：从最终用户检索需求角度评估

---

## 🔍 质量保证机制详解

### 输入验证
- **必需字段检查**：验证document_content和mode
- **模式相关验证**：
  - extraction模式必须提供tagging_taxonomy
  - mining模式建议提供max_new_tags
- **内容验证**：检查文档内容长度和有效性
- **分类体系验证**：验证tagging_taxonomy结构

### 标签正确性检测
- **自动检测机制**：对每个标签进行内容匹配验证
- **检测维度**：
  - 标签是否在文档内容中有明确证据
  - 标签与文档主题的相关性
  - 标签分类的合理性
- **检测结果**：标记为passed/failed，提供证据和建议
- **人工审核**：failed标签必须人工审核

### 质量指标
- **标签准确率**: ≥90%（目标值）
- **标签覆盖率**: ≥85%（目标值）
- **处理效率**: ≤3秒/千字（目标值）
- **正确性检测准确率**: ≥95%（目标值）

---

## 📊 持续改进机制

### 质量评估标准
1. **标签提取模式**：以标签体系匹配度和内容相关性为主要评估指标
2. **标签挖掘模式**：以内容覆盖度和新颖性为主要评估指标
3. **正确性检测**：以检测准确率和误报率为评估指标

### 持续改进机制
- **用户反馈收集**：定期收集用户对标签准确性的反馈
- **错误案例库**：建立标签提取错误案例库，用于模型训练优化
- **阈值调优**：定期评估标签提取准确率，动态调整置信度阈值
- **A/B测试**：对比不同策略的效果，持续优化算法

---

**文档版本**: v2.0  
**最后更新**: 2025-11-27